# Lecture 5: Image Classification with CNNs
## Stanford CS231n 10th Anniversary - April 15, 2025

---

## From Fully Connected to Convolutional

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROBLEM WITH FULLY CONNECTED NETWORKS                    â”‚
â”‚                                                                  â”‚
â”‚   Image: 224 Ã— 224 Ã— 3 = 150,528 pixels                         â”‚
â”‚   Hidden layer: 4096 neurons                                     â”‚
â”‚   Parameters: 150,528 Ã— 4096 = 616 MILLION weights!             â”‚
â”‚                                                                  â”‚
â”‚   Problems:                                                      â”‚
â”‚   1. Too many parameters (overfitting)                          â”‚
â”‚   2. Ignores spatial structure (pixel at (0,0) treated same     â”‚
â”‚      as pixel at (224,224))                                     â”‚
â”‚   3. Not translation invariant (cat in corner â‰  cat in center) â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   SOLUTION: CONVOLUTIONAL NEURAL NETWORKS (CNNs)                â”‚
â”‚                                                                  â”‚
â”‚   Key ideas:                                                     â”‚
â”‚   1. Local connectivity (neurons see small regions)             â”‚
â”‚   2. Weight sharing (same filter across entire image)           â”‚
â”‚   3. Hierarchy (lowâ†’midâ†’high level features)                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Convolution Operation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONVOLUTION                                   â”‚
â”‚                                                                  â”‚
â”‚   Slide a small FILTER (kernel) across the image                â”‚
â”‚   At each position: element-wise multiply + sum                 â”‚
â”‚                                                                  â”‚
â”‚   INPUT IMAGE (7Ã—7)           FILTER (3Ã—3)                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚   â”‚ 0  0  0  0  0  0  0 â”‚     â”‚ 1  0 -1 â”‚                       â”‚
â”‚   â”‚ 0  1  1  1  0  0  0 â”‚     â”‚ 1  0 -1 â”‚  (edge detector)     â”‚
â”‚   â”‚ 0  1  1  1  0  0  0 â”‚     â”‚ 1  0 -1 â”‚                       â”‚
â”‚   â”‚ 0  1  1  1  0  0  0 â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚   â”‚ 0  0  0  0  0  0  0 â”‚                                       â”‚
â”‚   â”‚ 0  0  0  0  0  0  0 â”‚     OUTPUT (5Ã—5)                      â”‚
â”‚   â”‚ 0  0  0  0  0  0  0 â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ 0  2  2  0  0â”‚                   â”‚
â”‚                               â”‚ 0  2  2  0  0â”‚                   â”‚
â”‚         â”Œâ”€â”€â”€â”                 â”‚ 0  2  2  0  0â”‚                   â”‚
â”‚    â”€â”€â”€â–º â”‚ * â”‚ â”€â”€â”€â”€â–º           â”‚ 0  0  0  0  0â”‚                   â”‚
â”‚         â””â”€â”€â”€â”˜                 â”‚ 0  0  0  0  0â”‚                   â”‚
â”‚        convolve               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                  â”‚
â”‚   Output size: (W - F + 2P) / S + 1                             â”‚
â”‚   W = input size, F = filter size, P = padding, S = stride      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Multiple Filters = Multiple Feature Maps

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CONVOLUTIONAL LAYER                                 â”‚
â”‚                                                                  â”‚
â”‚   INPUT VOLUME              FILTERS            OUTPUT VOLUME     â”‚
â”‚   (H Ã— W Ã— C)              (K filters)        (H' Ã— W' Ã— K)     â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚          â”‚          â”‚ F1â”‚ â”‚ F2â”‚         â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ â”‚        â”‚
â”‚   â”‚   RGB    â”‚    *     â”‚â”€â”€â”€â”‚ â”‚â”€â”€â”€â”‚   =     â”‚ â–’â–’â–’â–’â–’â–’â–’â–’ â”‚        â”‚
â”‚   â”‚  Image   â”‚          â”‚ F3â”‚ â”‚ F4â”‚         â”‚ â–“â–“â–“â–“â–“â–“â–“â–“ â”‚        â”‚
â”‚   â”‚          â”‚          â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜         â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚        â”‚
â”‚   â”‚ 32Ã—32Ã—3  â”‚          (4 filters          â”‚          â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           each 5Ã—5Ã—3)        â”‚ 28Ã—28Ã—4  â”‚        â”‚
â”‚                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â”‚   Each filter detects ONE type of feature:                      â”‚
â”‚   - Filter 1: vertical edges                                    â”‚
â”‚   - Filter 2: horizontal edges                                  â”‚
â”‚   - Filter 3: corners                                           â”‚
â”‚   - Filter 4: colors                                            â”‚
â”‚                                                                  â”‚
â”‚   Parameters: 4 Ã— (5Ã—5Ã—3 + 1 bias) = 304                        â”‚
â”‚   (Much less than fully connected!)                             â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CNN Feature Hierarchy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CNN FEATURE HIERARCHY                         â”‚
â”‚                                                                  â”‚
â”‚   INPUT          LAYER 1        LAYER 2        LAYER 3      OUT â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚     â”‚       â”‚  /  â”‚       â”‚ â—¢â—¤  â”‚       â”‚     â”‚            â”‚
â”‚   â”‚  K  â”‚  â”€â”€â–º  â”‚  \  â”‚  â”€â”€â–º  â”‚â—¢â—¤â—¢â—¤ â”‚  â”€â”€â–º  â”‚  K  â”‚  â”€â”€â–º "K"  â”‚
â”‚   â”‚     â”‚       â”‚ --- â”‚       â”‚     â”‚       â”‚     â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                  â”‚
â”‚   Raw pixels    Edges &       Parts &       Objects             â”‚
â”‚                 textures      shapes                            â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   WHAT EACH LAYER LEARNS:                                       â”‚
â”‚                                                                  â”‚
â”‚   Layer 1 (early):    Edges, colors, simple textures            â”‚
â”‚   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”       â”‚ / â”‚ \ â”‚ â”€ â”‚ â—‹ â”‚                        â”‚
â”‚   â”‚///â”‚\\\â”‚â”€â”€â”€â”‚       Edge detectors, Gabor-like filters        â”‚
â”‚   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                  â”‚
â”‚   Layer 2-3 (mid):    Corners, contours, texture patterns       â”‚
â”‚   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”       â”Œâ”€â”  â”€â”  â—‹                                â”‚
â”‚   â”‚â”Œâ”€ â”‚ â”€â”â”‚ â—‹ â”‚       â””â”€   â””   â—                                â”‚
â”‚   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                  â”‚
â”‚   Layer 4-5 (late):   Object parts, faces, wheels, eyes         â”‚
â”‚   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”       ğŸ‘  ğŸš—  ğŸ•                                 â”‚
â”‚   â”‚eyeâ”‚carâ”‚dogâ”‚       (Actual object parts!)                    â”‚
â”‚   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Image: CNN hierarchy visualization (images/lecture_5/page030_img83.png)*

---

## Pooling Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     POOLING                                      â”‚
â”‚                                                                  â”‚
â”‚   Reduce spatial dimensions while keeping important info        â”‚
â”‚                                                                  â”‚
â”‚   MAX POOLING (most common):                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”                                     â”‚
â”‚   â”‚ 1 3 â”‚ 2 1 â”‚     â”‚     â”‚                                     â”‚
â”‚   â”‚ 4 6 â”‚ 5 2 â”‚     â”‚ 6 5 â”‚  Take MAX in each region           â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤ â”€â”€â–º â”‚     â”‚  2Ã—2 pool, stride 2                 â”‚
â”‚   â”‚ 2 1 â”‚ 8 3 â”‚     â”‚ 4 8 â”‚                                     â”‚
â”‚   â”‚ 3 4 â”‚ 2 1 â”‚     â”‚     â”‚                                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚      4Ã—4              2Ã—2                                        â”‚
â”‚                                                                  â”‚
â”‚   AVERAGE POOLING:                                               â”‚
â”‚   Same idea but take AVERAGE instead of MAX                     â”‚
â”‚                                                                  â”‚
â”‚   WHY POOLING?                                                   â”‚
â”‚   1. Reduces computation (smaller feature maps)                 â”‚
â”‚   2. Provides translation invariance                            â”‚
â”‚   3. Increases receptive field                                  â”‚
â”‚                                                                  â”‚
â”‚   Note: Modern architectures use strided convolutions instead   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Typical CNN Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CNN ARCHITECTURE PATTERN                            â”‚
â”‚                                                                  â”‚
â”‚   INPUT â†’ [[CONV â†’ ReLU] Ã— N â†’ POOL] Ã— M â†’ [FC â†’ ReLU] Ã— K â†’ FC â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”â”‚
â”‚   â”‚INPUTâ”‚â”€â”€â–ºâ”‚CONV â”‚â”€â”€â–ºâ”‚MAXâ”‚â”€â”€â–ºâ”‚CONV â”‚â”€â”€â–ºâ”‚MAXâ”‚â”€â”€â–ºâ”‚ FC â”‚â”€â”€â–ºâ”‚ FC â”‚â”‚
â”‚   â”‚     â”‚   â”‚ReLU â”‚   â”‚   â”‚   â”‚ReLU â”‚   â”‚   â”‚   â”‚ReLUâ”‚   â”‚    â”‚â”‚
â”‚   â”‚224Â² â”‚   â”‚     â”‚   â”‚   â”‚   â”‚     â”‚   â”‚   â”‚   â”‚    â”‚   â”‚1000â”‚â”‚
â”‚   â”‚ Ã—3  â”‚   â”‚112Â² â”‚   â”‚56Â²â”‚   â”‚ 56Â² â”‚   â”‚28Â²â”‚   â”‚4096â”‚   â”‚    â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”˜   â”‚ Ã—64 â”‚   â”‚Ã—64â”‚   â”‚Ã—128 â”‚   â”‚128â”‚   â”‚    â”‚   â”‚    â”‚â”‚
â”‚             â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚   SPATIAL SIZE:   224 â†’ 112 â†’ 56 â†’ 56 â†’ 28 â†’ 1 â†’ 1              â”‚
â”‚   DEPTH:           3  â†’  64 â†’ 64 â†’ 128â†’ 128â†’ 4096â†’ 1000         â”‚
â”‚                                                                  â”‚
â”‚   Pattern: Spatial dims â†“,  Channels â†‘                          â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Activation Functions: ReLU

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ReLU                                       â”‚
â”‚                                                                  â”‚
â”‚   f(x) = max(0, x)                                              â”‚
â”‚                                                                  â”‚
â”‚         â†‘                                                        â”‚
â”‚      10 â”¤              â•±                                         â”‚
â”‚         â”‚            â•±                                           â”‚
â”‚         â”‚          â•±                                             â”‚
â”‚         â”‚        â•±                                               â”‚
â”‚       0 â”¼â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â†’                                        â”‚
â”‚         â”‚     â•±                                                  â”‚
â”‚     -10 â”¤   â•±                                                    â”‚
â”‚         â”‚ â•±                                                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚
â”‚        -10      0      10                                        â”‚
â”‚                                                                  â”‚
â”‚   ADVANTAGES:                                                    â”‚
â”‚   âœ“ Simple and fast (just max)                                  â”‚
â”‚   âœ“ No saturation for positive values                           â”‚
â”‚   âœ“ Sparse activation (many zeros â†’ efficient)                  â”‚
â”‚                                                                  â”‚
â”‚   DISADVANTAGE:                                                  â”‚
â”‚   âœ— "Dead ReLU" - if input always negative, neuron never learnsâ”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Image: ReLU plot (images/lecture_5/page045_img112.png)*

---

## What CNNs Learn: Visualizations

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LEARNED FILTERS (First Layer)                       â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”                             â”‚
â”‚   â”‚///â”‚\\\â”‚â”€â”€â”€â”‚|||â”‚â–’â–’â–’â”‚â–‘â–‘â–‘â”‚â–“â–“â–“â”‚â–ˆâ–ˆâ–ˆâ”‚                             â”‚
â”‚   â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤                             â”‚
â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚                             â”‚
â”‚   â”‚edgeâ”‚edgeâ”‚edgeâ”‚edgeâ”‚ color â”‚blobâ”‚                             â”‚
â”‚   â”‚detectors  â”‚orientedâ”‚ filters  â”‚                             â”‚
â”‚   â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜                             â”‚
â”‚                                                                  â”‚
â”‚   These are similar to Gabor filters (edge + orientation)       â”‚
â”‚   Learned automatically from data!                              â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   AVERAGE IMAGES PER CLASS (what network "sees"):               â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”                                     â”‚
â”‚   â”‚â–‘â–’â–“â–ˆâ”‚â–‘â–’â–“â–ˆâ”‚â–‘â–’â–“â–ˆâ”‚â–‘â–’â–“â–ˆâ”‚                                         â”‚
â”‚   â”‚face â”‚ car â”‚bird â”‚frog â”‚  (blurry because of variations)    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Image: Average class images grid (images/lecture_5/page024_img53.png)*

---

## Applications: Object Detection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  OBJECT DETECTION                                â”‚
â”‚                                                                  â”‚
â”‚   Not just "what" but also "where"                              â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚                                                â”‚            â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚            â”‚
â”‚   â”‚  â”‚ horse   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”                        â”‚            â”‚
â”‚   â”‚  â”‚  0.99   â”‚  â”‚personâ”‚                        â”‚            â”‚
â”‚   â”‚  â”‚    ğŸ´   â”‚  â”‚ 0.73 â”‚  â”Œâ”€â”€â”€â”€â”               â”‚            â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â”‚dog â”‚               â”‚            â”‚
â”‚   â”‚                         â”‚0.96â”‚               â”‚            â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â””â”€â”€â”€â”€â”˜               â”‚            â”‚
â”‚   â”‚  â”‚   car: 1.00  â”‚                            â”‚            â”‚
â”‚   â”‚  â”‚      ğŸš—     â”‚                             â”‚            â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚            â”‚
â”‚   â”‚                                                â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                  â”‚
â”‚   Output: List of (class, confidence, bounding_box)             â”‚
â”‚                                                                  â”‚
â”‚   Modern methods: YOLO, Faster R-CNN, SSD                       â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Image: Object detection examples (images/lecture_5/page035_img93.png)*

---

## Preview: Transformers in Vision

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TRANSFORMER ARCHITECTURE                            â”‚
â”‚                                                                  â”‚
â”‚   Originally for NLP, now also for vision (ViT)                 â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                    Outputs                              â”‚    â”‚
â”‚   â”‚                       â†‘                                 â”‚    â”‚
â”‚   â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚    â”‚
â”‚   â”‚                  â”‚ Softmax â”‚                           â”‚    â”‚
â”‚   â”‚                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                           â”‚    â”‚
â”‚   â”‚                  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                           â”‚    â”‚
â”‚   â”‚                  â”‚ Linear  â”‚                           â”‚    â”‚
â”‚   â”‚                  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                           â”‚    â”‚
â”‚   â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚    â”‚
â”‚   â”‚   ENCODER    â”‚    DECODER      â”‚                       â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Add & â”‚   â”‚   â”‚ Add &    â”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Norm  â”‚   â”‚   â”‚ Norm     â”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”¤   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Feed  â”‚   â”‚   â”‚  Feed    â”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Forwardâ”‚   â”‚   â”‚ Forward  â”‚  â”‚                       â”‚    â”‚
â”‚   â”‚ Nxâ”œâ”€â”€â”€â”€â”€â”€â”¤   â”‚ Nxâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Add & â”‚   â”‚   â”‚ Add &    â”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Norm  â”‚   â”‚   â”‚ Norm     â”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”¤   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Multi â”‚   â”‚   â”‚ Masked   â”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Head  â”‚   â”‚   â”‚Multi-Headâ”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â”‚Attn  â”‚   â”‚   â”‚ Attentionâ”‚  â”‚                       â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”¬â”€â”€â”€â”˜   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚                       â”‚    â”‚
â”‚   â”‚      â†‘       â”‚        â†‘        â”‚                       â”‚    â”‚
â”‚   â”‚  Input       â”‚   Output        â”‚                       â”‚    â”‚
â”‚   â”‚  Embedding   â”‚   Embedding     â”‚                       â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚    â”‚
â”‚                                                             â”‚    â”‚
â”‚   Key innovation: ATTENTION allows global context          â”‚    â”‚
â”‚   (covered in detail in Lecture 7)                         â”‚    â”‚
â”‚                                                             â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*Image: Transformer architecture (images/lecture_5/page040_img105.png)*

---

## Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    KEY TAKEAWAYS                                 â”‚
â”‚                                                                  â”‚
â”‚   1. CNNs exploit spatial structure of images                   â”‚
â”‚      - Local connectivity (small receptive fields)              â”‚
â”‚      - Weight sharing (same filter everywhere)                  â”‚
â”‚      - Much fewer parameters than fully connected               â”‚
â”‚                                                                  â”‚
â”‚   2. CONVOLUTION = sliding filter, element-wise multiply + sum  â”‚
â”‚      - Multiple filters â†’ multiple feature maps                 â”‚
â”‚      - Each filter detects one type of pattern                  â”‚
â”‚                                                                  â”‚
â”‚   3. Feature HIERARCHY: edges â†’ textures â†’ parts â†’ objects     â”‚
â”‚      - Early layers: simple patterns                            â”‚
â”‚      - Later layers: complex, semantic features                 â”‚
â”‚                                                                  â”‚
â”‚   4. POOLING reduces spatial size, provides invariance          â”‚
â”‚      - Max pooling most common                                  â”‚
â”‚      - Modern: strided convolutions instead                     â”‚
â”‚                                                                  â”‚
â”‚   5. Typical pattern: CONV-RELU-POOL repeated, then FC layers  â”‚
â”‚      - Spatial dims decrease, channels increase                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Image References

Key images from: `images/lecture_5/`

- `page020_img45.png` - Tree frog example
- `page024_img53.png` - Average class images grid
- `page030_img83.png` - CNN feature hierarchy (letter K)
- `page035_img93.png` - Object detection examples
- `page040_img105.png` - Transformer architecture
- `page045_img112.png` - ReLU activation plot
